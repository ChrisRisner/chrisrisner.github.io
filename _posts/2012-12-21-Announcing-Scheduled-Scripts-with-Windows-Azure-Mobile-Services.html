---
layout: post
title: "Announcing Scheduled Scripts with Windows Azure Mobile Services"
date: Fri Dec 21 2012 12:35:00 GMT-0800 (PST)
comments: true
status: publish
type: post
published: true
categories: [Azure, Mobile Services]
excerpt: "This post briefly goes over the schedule job capabilities of Windows Azure Mobile Services.  Using this new ability, you can generate server side scripts which will either run on demand when you want or on a scheduled basis."
logoUrl: null
keywords: Mobile Services,Windows Azure,Azure,Windows Azure Mobile Services,Scheduled jobs,Cron,On demand,scripts,walkthrough
filepath: 2012-12-21-Announcing-Scheduled-Scripts-with-Windows-Azure-Mobile-Services.html
disqus_identifier: Announcing-Scheduled-Scripts-with-Windows-Azure-Mobile-Services
---
{% include special/mobile_services_to_apps.html %}

<p><img style="margin: 0px 0px 5px 5px; display: inline; float: right" title="Windows Azure Mobile Services" alt="Windows Azure Mobile Services" align="right" src="http://storage.chrisrisner.com/images/WAMobileServicesblue.png" width="160" height="237" />Today I’m happy to announce the availability of scheduled scripts inside of <a title="Windows Azure Mobile Services" href="http://windowsazure.com/mobile">Windows Azure Mobile Services</a>.&#160; Scheduled scripts, also known as <strong>CRON jobs</strong>, allow you to define a server side script (just like you can for table CRUD operations) that you can then make run on a schedule or on demand if you want.&#160; This opens up a wide array of scenarios to do background processing, on the fly push notifications to users, and many other things.&#160; Today I’m going to walk you through creating a very simple script which will compliment the quick start application that is available with Mobile Services.&#160; I’ll walk through creating a new service quickly but if you want, you can skip that step and go down to the Scheduler part beneath it.</p>  <p><strong>Creating our Mobile Service</strong></p>  <p>Start by logging into the <a title="Windows Azure Portal" href="http://manage.windowsazure.com">Windows Azure portal</a> and going to Mobile Services.&#160; Click the create button in the bottom left of the portal and choose a new Mobile Service:</p>  <p align="center"><img title="new mobile service" alt="new mobile service" src="http://storage.chrisrisner.com/images/new-mobile-service.jpg" /></p>  <p>In the next screen, pick a URL for your service, choose whether you want to use an existing SQL database or create a new one, and select the region you want your service hosted in.&#160; Proceed to the second screen and complete the database settings.&#160; When you’re done with that click the checkmark in the bottom right and your Mobile Service should start being created.&#160; After it switches from <strong>Creating</strong> to <strong>Ready</strong>, you can click into your new Mobile Service.&#160; The first screen you’ll get to is the quick start.&#160; I’m going to use the iOS platform today and follow the <strong>Create a new iOS app</strong> instructions.&#160; After creating the <strong>TodoItem</strong> table and downloading my project, I can run my application and get a simplified Todo list app when I’ve used to add a few items:</p>  <p align="center"><img title="todo list with items" alt="todo list with items" src="http://storage.chrisrisner.com/images/wams-test-before-scheduled-script.jpg" width="237" height="338" /></p>  <p>Now we’ll look at scheduling a script.</p>  <p><strong>Scheduling Scripts</strong></p>  <p>For the next steps, I’m going to talk about and add a scheduled script to my app.&#160; For this example, I’m assuming that you’re using the quick start app and that you’ve already created the <strong>TodoItem</strong> table and inserted some items.&#160; Let’s return to the portal and at the top of the screen for your Mobile Service, you should now see a <strong>Scheduler</strong> tab:</p>  <p align="center"><img title="Scheduler tab in Mobile Services" alt="Scheduler tab in Mobile Services" src="http://storage.chrisrisner.com/images/wams-scheduler-tab.jpg" /></p>  <p>Go ahead and click on that tab.&#160; The next screen should inform you that there aren’t any scheduled jobs for your Mobile Service and should have a link to <strong>Create a Scheduled Job</strong>.&#160; Go ahead and click the create link.&#160; The next window should look like this:</p>  <p align="center"><img title="Creating a scheduled job" alt="Creating a scheduled job" src="http://storage.chrisrisner.com/images/wams-new-scheduled-job.jpg" /></p>  <p>Here we can specify a name for our job and then choose what schedule to run it on or to run it on demand.&#160; I’m going to name my job <strong>AddTodoItem</strong> and schedule it to run on demand.&#160; After creating it, you’ll see a grid of all your (currently only one) scheduled jobs:</p>  <p align="center"><img title="Scheduled Jobs" alt="Scheduled Jobs" src="http://storage.chrisrisner.com/images/wams-scheduled-jobs.jpg" /></p>  <p>Here we can see that our job is disabled, that it hasn’t been run before and isn’t set to run at any time in the future, and that it’s frequency of running is <strong>On demand</strong>.&#160; Tapping anywhere within the right four columns of your service will show you a <strong>Enable</strong> and <strong>Delete</strong> button at the bottom.&#160; The <strong>Enable</strong> button is only necessary if we are running the job on a schedule and not on demand.&#160; That way you could have multiple jobs and turn them on and off without needing to change their frequency.&#160; Click on the job’s name and you’ll be taken to the configuration screen:</p>  <p align="center"><img title="Scheduled Job config" alt="Scheduled Job config" src="http://storage.chrisrisner.com/images/wams-scheduled-job-config.jpg" width="357" height="406" /></p>  <p>Here we get a lot of the same information as we did on the grid in addition to being able to change the <strong>Schedule</strong> near the bottom.&#160; At the bottom of this screen, you’ll see again see an <strong>Enable</strong> and <strong>Delete</strong> button.&#160; Additionally, you’ll see the very important <strong>Run Once</strong> button:</p>  <p align="center"><img title="Run once button" alt="Run once button" src="http://storage.chrisrisner.com/images/wams-scheduled-job-run-once-button.jpg" /></p>  <p>We’ll use this button shortly to run our script.&#160; For now click the <strong>Script</strong> link near the top under the job name.&#160; This screen is where we can actually define our script as well as run it:</p>  <p align="center"><img title="editing a scheduled job script" alt="editing a scheduled job script" src="http://storage.chrisrisner.com/images/wams-definig-job-script.jpg" /></p>  <p>I’m going to change that script to handle inserting a new Todo item:</p>  <p><script src="https://gist.github.com/4355481.js?file=AddTodoItem.js"></script></p>  <p>Here we’re just getting a reference to the <strong>TodoItem </strong>table and then calling it’s <strong>insert</strong> method.&#160; We pass into that a dynamically created object that has the same properties we’re sending in the application, a <strong>text</strong> field and a <strong>complete</strong> field.&#160; Notice that we’re putting the current date into the <strong>text</strong> property so we can visualize the items getting added more easily.&#160; Now save your script and after it’s saved, click the <strong>Run Once</strong> button.&#160; After it starts, you should see a message which says <strong>The following job was successfully started: ‘AddTodoItem’</strong>.&#160; Notice that this just means the job has started, not that it’s finished.&#160; We can check on the success by running our app and seeing if a todo was added:</p>  <p align="center"><img title="Added a todo from a scheduled job" alt="Added a todo from a scheduled job" src="http://storage.chrisrisner.com/images/wams-new-todo-from-schedule.jpg" /></p>  <p>As you can see, the script added my todo and it’s appearing without any issues.&#160; If for some reason it didn’t show up, we could return to the portal and go to the Mobile Service’s <strong>Logging</strong> tab to see if our script recorded any errors.</p>  <p><strong>Limitations</strong></p>  <p>There is one important limitations to scheduled jobs and that is the number that you can have.&#160; When you’re running in the free preview for Mobile Services, you are <strong>limited to one scheduled job per mobile service </strong>(not per subscription).&#160; You can increase this limit by moving up to a paid reserved instance if you want.&#160; If you do try to create another scheduled job, you’ll see a notification appear at the bottom of the portal which says <strong>Cannot create scheduler job.&#160; The maximum number of scheduler jobs in free mode is 1.&#160; To create more jobs, please use the Scale tab to switch your service to reserved mode.</strong></p>  <p><strong>Conclusion</strong></p>    <p>Today we released Scheduled scripts for Windows Azure Mobile Services.&#160; This allows you to run both on the fly and scheduled scripts.&#160; Today we just inserted another item into our table but there are tons of things you can do inside of these jobs.&#160; If you wanted to trigger an on the fly push notification, you could do it here.&#160; If you wanted to send a daily email (using the <strong>Send Grid </strong>module) you could set it up as a job here.&#160; These are just a couple things you might want to do.&#160; Additionally, as the capabilities of the server side scripts grow, you’ll be able to make use of new capabilities from both the CRUD scripts and your scheduled job scripts.&#160; There is <a title="Scott&#39;s update on Mobile services" href="http://weblogs.asp.net/scottgu/archive/2012/12/21/great-updates-to-windows-azure-mobile-services-web-sites-sql-data-sync-acs-media-more.aspx">more information available on Scheduled Scripts at Scott Gu’s blog here</a>.&#160; You can <a title="Free Windows Azure Trial" href="http://aka.ms/WA-MobileServices">sign up for a free Windows Azure trial and get access to Mobile Services here</a>.</p>