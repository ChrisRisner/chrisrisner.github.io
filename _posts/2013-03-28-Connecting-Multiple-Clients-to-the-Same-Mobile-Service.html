---
layout: post
title: "Connecting Multiple Clients to the Same Mobile Service"
date: Thu Mar 28 2013 08:51:00 GMT-0700 (PDT)
comments: true
status: publish
type: post
published: true
categories: [Android, Azure, Mobile Services, Objective-C, Java, iOS]
excerpt: "This brief article walks through connecting clients on different platforms to the same Windows Azure Mobile Service.  As you'll see, no additional steps need to be taken to connect multiple clients to the same service."
logoUrl: null
keywords: Mobile Services,Windows Azure,Azure,Mobile,iOS,Android,Cross Platform,backend,same backend,BaaS,Mobile Backend
filepath: 2013-03-28-Connecting-Multiple-Clients-to-the-Same-Mobile-Service.html
disqus_identifier: Connecting-Multiple-Clients-to-the-Same-Mobile-Service
---
<p><img style="margin: 0px 0px 5px 5px; display: inline; float: right" title="Mobile Services" alt="Mobile Services" align="right" src="http://storage.chrisrisner.com/images/WAMobileServicesblue.png" />Pretty frequently we are asked if or how you connect multiple clients to the same Mobile Service.&#160; The great thing about Mobile Services is that it’s meant to be the backend for your cross-platform apps.&#160; One app on several platforms with just a single Mobile Service backend.&#160; To facilitate demonstrating that fact, I’m going to review a sample I put out for iOS and Android a little while back: Feedback.&#160; The application allows your users to enter feedback (let’s say about the application) and then records it into Mobile Services.&#160; This is a really simple sample but demonstrates how we can use the same backend in both apps.&#160; You can access both the <a title="Android Mobile Services Feedback" href="https://github.com/WindowsAzure-Samples/Android-MobileServices-Feedback">Android</a> and <a title="iOS Mobile Services Feedback" href="https://github.com/WindowsAzure-Samples/iOS-MobileServices-Feedback">iOS</a> source code on GitHub. </p>  <p><strong>What about other platforms?</strong></p>  <p>This sample is just done in Android and iOS right now.&#160; However, we could also connect a Windows Store or Windows Phone or HTML/JS app using their SDKs to the same service.&#160; In fact, using the REST API that is exposed by the Mobile Service, we could connect any application we want as long as it’s capable of doing an HTTP Post to our service.&#160; All of these clients and we can use the same single backend.</p>  <p><strong>Creating a Mobile Service</strong></p>  <p>The first step is to create a new Mobile Service.&#160; Before you can do that, you’ll need a Windows Azure account.&#160; If you don’t have one already, you can <a title="Free Windows Azure Trial" href="https://www.windowsazure.com/en-us/pricing/free-trial/">sign up for a free 90 day trial here</a>.&#160; Once you’ve done that, you can follow the steps listed <a title="Setting up your Mobile Service" href="http://chrisrisner.com/Adding-Auth-and-Logging-out-of-an-iOS-Windows-Azure-Mobile-Services-App">here</a> under the <strong>Setting up the app</strong> header.&#160; Once you’ve created your Mobile Service, click into it click the <strong>MANAGE KEYS</strong> button at the bottom:</p>  <p align="center"><img title="Manage Keys" alt="Manage Keys" src="http://storage.chrisrisner.com/images/azure-storage-manage-keys.jpg" /></p>  <p>Here you can copy your <strong>APPLICATION KEY</strong> which you’ll need in your client applications along with the name of your Mobile Service.&#160; Before we move on to the clients, go to the <strong>DATA</strong> tab (in the top of the portal) and click the <strong>CREATE</strong> button at the bottom.&#160; Name the table <strong>Feedback</strong> and leave the permissions as <strong>Anybody with the Application Key</strong>.</p>  <p><strong>The Client</strong></p>  <p>Regardless of whether you’re working with the <a title="Android Feedback" href="https://github.com/WindowsAzure-Samples/Android-MobileServices-Feedback">Android</a> or <a title="iOS Feedback" href="https://github.com/WindowsAzure-Samples/iOS-MobileServices-Feedback">iOS</a> repositories, all you’ll need to do is set the Mobile Service URL and Application Key before you can run the apps.&#160; We’ll be working off of the <strong>source/end</strong> folder for these samples.&#160; If you’re doing the Android app, open the FeedbackService.java and set the URL and Key in the constructor:</p>  <p><script src="https://gist.github.com/ChrisRisner/5260966.js?file=FeedbackService.java"></script></p>  <p>If you’re doing iOS instead, open up FeedbackService.m and set the URL and Key in the <strong>init</strong> method:</p>  <p><script src="https://gist.github.com/ChrisRisner/5260966.js?file=FeedbackService.m"></script></p>  <p>Now before we run the application, let’s look at the code that will actually handle inserting the feedback to our Mobile Service.</p>  <p><strong>Inserting data</strong></p>  <p>The code for inserting data is actually incredibly similar between the iOS and Android apps (outside of syntax of course).&#160; For Android, we have this code (also from the FeedbackService.java file):</p>  <p><script src="https://gist.github.com/ChrisRisner/5260966.js?file=FeedbackInsert.java"></script></p>  <p>And for iOS (also from FeedbackService.m) we have this:</p>  <p><script src="https://gist.github.com/ChrisRisner/5260966.js?file=FeedbackInsert.m"></script></p>  <p>There are two real differences between these two method calls.&#160; The first is that the iOS version uses an NSDictionary which is essentially an array of key-value pairs.&#160; The Android version uses a strongly typed object named <strong>Feedback</strong>.&#160; Behind the scenes in the Mobile Services SDK, the same thing ends up happening: the data is serialized into JSON and sent up to the Mobile Service.&#160; The second difference is that the Android version just calls the callback sent into it where the iOS version attempts to log an error, if there was one, and then calls whatever completion handler was sent into it.&#160; </p>  <p><strong>Running the Apps</strong></p>  <p>I’ll go ahead and start up both versions of the app.&#160; The first thing we’ll see on both is a screen with a single button to <strong>Send Feedback</strong>.&#160; Tapping on that takes us to the Feedback screen:</p>  <p align="center"><img title="Android feedback app" alt="Android feedback app" src="http://storage.chrisrisner.com/images/android-feedback-app.jpg" width="227" height="339" /><img title="iOS Feedback App" alt="iOS Feedback App" src="http://storage.chrisrisner.com/images/ios-feedback-app.jpg" width="229" height="339" /></p>  <p>Before we fill out the forms and hit submit (not visible on the Android version on the left, you have to scroll down a little), let’s check out the portal for a second.&#160; Go back to the <strong>DATA</strong> tab and click on your <strong>Feedback</strong> table.&#160; It should currently say “This table contains no records.”&#160; Go back to your application and fill it out.&#160; I’ll go ahead and do so for both versions and submit:</p>  <p align="center"><img title="Android Feedback Filled out" alt="Android Feedback Filled out" src="http://storage.chrisrisner.com/images/android-feedback-app-filled-out.jpg" width="227" height="339" /><img title="iOS Feedback filled out" alt="iOS Feedback filled out" src="http://storage.chrisrisner.com/images/ios-feedback-app-filled-out.jpg" width="227" height="339" /></p>  <p>Now after submitting, let’s return to the portal.&#160; Hit the <strong>REFRESH</strong> button at the bottom of the screen and you should now see your data showing up in the portal:</p>  <p align="center"><img title="Feedback app data" alt="Feedback app data" src="http://storage.chrisrisner.com/images/wams-feedback-app-data.jpg" /></p>  <p><strong>Portability</strong></p>  <p>The Feedback portion of these apps were designed so that you could take the Feedback forms and drop them into your applications very easily.&#160; From the Android side, you just need to take the Feedback, FeedbackActivity, FeedbackService classes and activity_feedback layout and drop them into your application.&#160; Once you’ve configured FeedbackService to use your Mobile Service URL and key, you just need to launch the FeedbackActivity and it will record your feedback (you’ll also need to make sure FeedbackActivity is in your manifest).&#160; For iOS, there is a MSFeedback file group that you can copy over to your project.&#160; The UI for the feedback form is put into xib files, so even if you’re using storyboards, you can easily drop the feedback stuff into your own application.</p>  <p><strong>Conclusion</strong></p>  <p>Today we saw how easy it is to use the same Mobile Service as a backend for apps running on different platforms.&#160; In this case it was iOS and Android, however, you could continue to connect other clients to this Mobile Service or choose a different mix of clients if you wanted.&#160; With Mobile Service’s official support for Android, iOS, HTML/JS, Windows Phone, and Windows Store apps, you’re easily able to use the same Mobile Service as a backend for most different app platforms.&#160; Finally, we saw how easy it is to use Mobile Services to gather feedback on your application even if this is the only way you’re using Mobile Services.&#160; </p>