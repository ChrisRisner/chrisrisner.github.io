---
layout: post
title: "31 Days of iOS: Day 26-Push Notifications Part 1: The Setup"
date: Sat Jan 26 2013 08:53:00 GMT-0800 (PST)
comments: true
status: publish
type: post
published: true
categories: [Mobile, Objective-C, Apple, XCode, iOS, Azure, Mobile Services]
excerpt: "In day 26 of the 31 Days of iOS, we start to talk about Push Notifications.  This post covers how to get your app set up to handle push notifications with in the Apple Developer Portal."
logoUrl: null
keywords: iOS,31 days of iOS,Apple,Apple iOS,push notifications,Apple Dev Portal,certificate,provisioning profile,APNS,Apple Push Notification ServiceApp ID,iOS Introduction,iOS Tutorial,iOS for Beginners,Beginners,walkthrough
filepath: 2013-01-26-31-Days-of-iOS--Day-26-Push-Notifications-Part-1--The-Setup.html
disqus_identifier: 31-Days-of-iOS--Day-26–Push-Notifications-Part-1--The-Setup
redirect_from:
  - /2013-01-26-31-Days-of-iOS--Day-26%E2%80%93Push-Notifications-Part-1--The-Setup/
  - /2013-01-26-31-Days-of-iOS--Day-26–Push-Notifications-Part-1--The-Setup/
  - /31-Days-of-iOS--Day-26–Push-Notifications-Part-1--The-Setup/
  - /31-Days-of-iOS--Day-26–Push-Notifications-Part-1--The-Setup
---
{% include special/mobile_services_to_apps.html %}

<p><img style="margin: 0px 0px 5px 5px; display: inline; float: right" align="right" src="http://chrisrisner.com/upload/200px-Apple-logo.png" width="170" height="208" />Welcome to Day 26 of the <a title="31 Days of iOS" href="http://chrisrisner.com/31-Days-of-iOS">31 Days of iOS</a>.&#160; <a title="Day 25: The Application Life Cycle" href="http://chrisrisner.com/31-Days-of-iOS--Day-25%E2%80%93The-Application-Life-Cycle">Yesterday</a>, we wrapped up a two part mini-series on life cycle events on the application object and view controllers.&#160; Today we’re going to start discussing the very important topic of <strong>Push Notifications</strong>.&#160; Push notifications enable your apps to get information from an outside source.&#160; Instead of your app only being able to pull information down when running, we’re going to see how it’s possible to send data to our apps whenever we want.&#160; One <strong>VERY IMPORTANT</strong> thing I’d like to point out is that you NEED to be a registered iOS developer in order to follow along today.&#160; There are steps you can’t take (like moving the app to a device) unless you are.&#160; Also, you can’t test push notifications on the simulator, you’ll need to have an iOS device in order to test this out.&#160; We won’t be doing any coding today as there is a lengthy set up process we need to go through first involving the Apple developer portal.&#160; Tomorrow we’ll implement all of the code and actually test out our push notifications.</p>  <p><strong>A bit about client server stuff</strong></p>  <p>In order to test and demonstrate push notifications, we have to have some way to send those push notifications.&#160; Unfortunately, there isn’t a way to do that from the Apple dev portal.&#160; What we really need is a computer that can send information to <strong>Apple’s Push Notification Service (APNS)</strong> in order to have it deliver the push notification.&#160; I could always run something locally or deploy something somewhere but in order to make things as easy on me as possible and not focus on the server side today, I’m going to use something I am familiar with, <a title="Windows Azure Mobile Services" href="http://www.windowsazure.com/mobile">Windows Azure Mobile Services</a>.&#160; This will allow me to easily test out sending a push notification without us getting into specifics of how it’s done.&#160; Once you’re done reading this, if you’re interested I have a <a title="Windows Azure Mobile Services articles" href="http://chrisrisner.com/Category/Mobile%20Services">bunch of other articles on what you can accomplish with Mobile Services</a> besides just testing push which we’ll do today. </p>  <p><strong>The Apple dev portal</strong></p>  <p>Unfortunately, a lot of what we have to do today isn’t strictly code related.&#160; Due to how Apple restricts developers from putting applications on to devices and how push notifications and signing applications work, we have to do a fair amount of work in the portal.&#160; So, start by launching Safari (or whatever browser you prefer) and go to <a href="http://developer.apple.com">http://developer.apple.com</a>.&#160; After logging in, select the <strong>iOS Provisioning Portal</strong> from the <strong>Developer Program Resources</strong>.&#160; Once here, click on the<strong> Devices</strong> link on the left.&#160; Ensure that your device is showing up here:</p>  <p align="center"><img title="Devices in iOS Provisioning Portal" alt="Devices in iOS Provisioning Portal" src="http://storage.chrisrisner.com/images/31iosday26-devices.jpg" /></p>  <p>After that, click on <strong>Certificates</strong>, and make sure your certificate is showing up:</p>  <p align="center"><img title="your cert" alt="your cert" src="http://storage.chrisrisner.com/images/31iosday26-your-cert.jpg" /></p>  <p>These steps aren’t strictly part of getting push notifications to work but if they aren’t in place, things won’t work later on.&#160; Now tap on <strong>App IDs</strong>.&#160; The dev portal has the concept of <strong>Wildcard</strong> app IDs which allow you to use the same certificate and profile for multiple apps while developing (along with some other reasons).&#160; However, if you want to us APNS, as well as several other Apple resources, your app needs to have a unique ID that can’t be shared with other apps.&#160; This ID is going to be unique to your app from all the other apps in the store and on a device.&#160; Go ahead and click the <strong>New App ID</strong> button in the top right.&#160; In the page that comes up, you’ll need to enter a <strong>Description</strong> and a <strong>Bundle Identifier</strong>.&#160; The <strong>Description</strong> can be whatever you want and is used in the provisioning portal to identify your app.&#160; The <strong>Bundle Identifier</strong> is what is really important.&#160; This is that unique ID that identifies your app.&#160; The example given in the portal is <strong>com.domainname.appname</strong> and this is the format many organizations use for their apps and what we’ll use today.&#160; It’s extremely important that the <strong>appname</strong> part of your identifier matches your app name as this part is hard-coded to your project in Xcode and can’t be changed.&#160; There is also an read-only <strong>Bundle Seed ID</strong>.&#160; This gets prepended automatically to your identifier and is a unique identifier for your iOS Developer account (or your team’s account if you’re part of one).&#160; I’m going to make my identifier <strong>com.cmr.DayTwentySix</strong>:</p>  <p align="center"><img title="New App ID" alt="New App ID" src="http://storage.chrisrisner.com/images/31iosday26-app-id.jpg" width="308" height="365" /></p>  <p>One other thing you should know is that (as of now) there isn’t a way to get rid of an App ID once it’s in your portal.&#160; So make sure things are right before you hit <strong>Submit</strong>.&#160; With that done we can scroll down the list (if you already have app’s) and find the one we just created:</p>  <p align="center"><img title="App Details in list" alt="App Details in list" src="http://storage.chrisrisner.com/images/31iosday26-app-details.jpg" width="653" height="145" /></p>  <p>&#160;</p>  <p>As you can see, <strong>Push Notification</strong> are marked as <strong>Configurable</strong>.&#160; Depending on where your app is in your list, you may not be able to see the column headers but all of the indicators on the left side are for the <strong>Development</strong> version of your app and the right are for <strong>Production</strong>.&#160; Click on the <strong>Configure</strong> link now.&#160; </p>  <p><strong>Configuring App ID</strong></p>  <p>Here we can do many things including configuring for <strong>APNS</strong>, <strong>iCloud</strong>, <strong>Passes</strong>, and <strong>Data Protection</strong>.&#160; Today we’re interested in <strong>APNS</strong>:</p>  <p align="center"><img title="Enable APNS" alt="Enable APNS" src="http://storage.chrisrisner.com/images/31iosday26-enable-apns.jpg" width="686" height="141" /></p>  <p>We first need to check the box at the top left.&#160; Then the <strong>Configure</strong> buttons will become enabled.&#160; Click the one to the right of <strong>Development</strong>.&#160; The next screen will walk you through <strong>Generating a Certificate Signing Request</strong>.&#160; This is a file you can generate using the <strong>Keychain Access </strong>application in OSX.&#160; Follow those steps to generate your CSR file and then click <strong>Continue</strong>.&#160; In the next window, click <strong>Choose File</strong> and browse to and find your CSR file and then click <strong>Generate</strong>.&#160; After a moment you should see a successful message:</p>  <p align="center"><img title="Cert generated" alt="Cert generated" src="http://storage.chrisrisner.com/images/31iosday26-cert-generated.jpg" /></p>  <p>Click <strong>Continue</strong> and you’ll be able to <strong>Download</strong> the cert.&#160; Do so now.&#160; After downloading, find the <strong>cer</strong> file you just downloaded and double click it.&#160; This should open up the <strong>Keychain Access</strong> app.&#160; Under <strong>My Certificates</strong>, you should see one matching your app name.&#160; Mine for example is <strong>Apple Development IOS Push Services: com.cmr.DayTwentySix</strong>.&#160; Right click on your cert and choose the <strong>Export</strong> option:</p>  <p align="center"><img title="Export cert" alt="Export cert" src="http://storage.chrisrisner.com/images/31iosday26-export.jpg" /></p>  <p>This will allow you to export a <strong>Personal Information Exchange</strong> or <strong>p12</strong> file.&#160; However you are testing your push notifications, you’ll need this file to sign your requests to send a push notification.&#160; The <strong>APNS </strong>servers then inspect those requests to make sure they were signed with the same <strong>p12</strong> file.&#160; When you do the export, you’ll have the option to enter a password.&#160; It’s recommended that you do, just don’t forget what that password is.&#160; Now return to the portal and you should see the light has changed from yellow to green and says <strong>Enabled</strong> for the development push settings.&#160; </p>  <p><strong>Provisioning Profile</strong></p>  <p>Return to the top of the portal and click <strong>Provisioning</strong> on the left. The last step we need to take is to produce a provisioning profile specific to our app.&#160; When you create an iOS dev account, you automatically get an <strong>iOS Team Provisioning Profile</strong> that is tied to your wildcard app ID.&#160; That is to say, you can sign any application from your account with it to put it on a device (as long as that device is also connected to your development account).&#160; However, in order to make use of the app specific stuff we just set up (<strong>APNS</strong>) we need a profile JUST for this app.&#160; Click the <strong>New Profile</strong> button in the top right.&#160; We’re asked for a profile name, which cert to use, which <strong>App ID</strong> to use, and which devices to allow it on.&#160; Make sure you’ve selected the right <strong>App ID</strong> if you have multiple:</p>  <p align="center"><img title="New profile" alt="New profile" src="http://storage.chrisrisner.com/images/31iosday26-new-profile.jpg" width="373" height="248" /></p>  <p>After filling in the details, click <strong>Submit</strong>.&#160; You’ll be taken back to the list of profiles where the new one should show up as <strong>Pending</strong>.&#160; Refresh your browser after a moment and it should show up as <strong>Active</strong>.&#160; Click the <strong>Download </strong>button to the right of it to download it locally and then double click the file.&#160; This should give you the ability to import it into your list of local profiles.&#160; You can check this by opening Xcode and going to the <strong>Window</strong> menu and choosing <strong>Organizer</strong>.&#160; In <strong>Provisioning Profiles</strong> under <strong>Library</strong>, you should see your profile:</p>  <p align="center"><img title="Provisioning Profile in Organizer" alt="Provisioning Profile in Organizer" src="http://storage.chrisrisner.com/images/31iosday26-organizer.jpg" width="767" height="128" /></p>  <p>If that all went well then you’re ready to test out push notifications.&#160; We’ll be addressing the coding portion of that tomorrow.</p>  <p><strong>Conclusion</strong></p>  <p>Today we started reviewing how push notifications work with <strong>APNS</strong>.&#160; We covered the first half of what is necessary with push notifications which was all done in the Apple developer portal.&#160; Due to how each device is tied to a developer account and every app that goes on those devices needs to be signed and every request to <strong>APNS</strong> has to be signed in a way that matches up with what’s in the portal, the set up process was pretty complicated.&#160; Thankfully this means that all we need to do tomorrow is the code.</p>