---
layout: post
title: "31 Days of iOS: Day 28–Activity Indicators"
date: Mon Jan 28 2013 05:24:00 GMT-0800 (PST)
comments: true
status: publish
type: post
published: true
categories: [Mobile, Objective-C, XCode, iOS]
excerpt: "In day 28 of the 31 Days of iOS we review how to display activity indicators to users so they know something is happening in the background in your app.  We also talk about how to turn on and off the network activity indicator."
logoUrl: null
keywords: iOS,31 days of iOS,Apple,Apple iOS,activity indicator,UIActivityIndicatorView,hides when stopped,startAnimating,stopAnimating,network activity,iOS Introduction,iOS Tutorial,iOS for Beginners,Beginners,walkthrough
filepath: 2013-01-28-31-Days-of-iOS--Day-28–Activity-Indicators.html
disqus_identifier: 31-Days-of-iOS--Day-28–Activity-Indicators
---
<p><img style="margin: 0px 0px 5px 5px; display: inline; float: right" align="right" src="http://chrisrisner.com/upload/200px-Apple-logo.png" width="170" height="208" />Welcome to Day 28 of the <a title="31 Days of iOS" href="http://chrisrisner.com/31-Days-of-iOS">31 Days of iOS</a>.&#160; <a title="Day 27: Sending and Receiving Push Notifications" href="http://chrisrisner.com/31-Days-of-iOS--Day-27%E2%80%93Push-Notifications-Part-2--The-Code">Yesterday</a>, we wrapped up a two part mini-series on Push Notifications.&#160; Since getting set up for push notifications is so complicated, we had to split that into a separate entry from the code part of it.&#160; Today we’re going to talk about something that impacts many of the other entries in the series: showing activity indicators.&#160; If you’re performing long running network communication or doing any other sort of backend processing, you’ll want to make sure the user knows something is going on.&#160; This is often done with a progress indicator of some kind.&#160; Any time you’ve seen the spinning color wheel in OS X or the hourglass in Windows, you’ve been looking at an activity indicator.&#160; We’ll be starting with a brand new project, but if you’d like to <a title="iOS Day 28 source code" href="http://storage.chrisrisner.com/codesamples/iOSDayTwentyEight.zip">follow along with the completed code, you can access it here</a>.</p>  <p><strong>Creating our project</strong></p>  <p>Open up Xcode and choose <strong>File</strong>, <strong>New</strong>, <strong>Project</strong>.&#160; We’ll use a <strong>Single View Application</strong> and name it DayTwentyEight:</p>  <p align="center"><img title="Day 28 project" alt="Day 28 project" src="http://storage.chrisrisner.com/images/31iosday28-new-project.jpg" /></p>  <p>We’re going to use a very simplified UI today.&#160; We are only going to add a single button for now.&#160; Open up <strong>MainStoryboard.storyboard</strong> and drag a <strong>round rect button</strong> from the UI element selector in the bottom right on to your view.&#160; When you’re done, your UI will look like this:</p>  <p align="center"><img title="Day 28 UI" alt="Day 28 UI" src="http://storage.chrisrisner.com/images/31iosday28-ui.jpg" /></p>  <p>Open up the <strong>Assistant Editor</strong> in the top right of Xcode and <strong>control + drag and drop</strong> from the button to your code behind to create a new action.&#160; After adding it, your <strong>ViewController.h </strong>will look like this:</p>  <p><script src="https://gist.github.com/4441051.js?file=ViewController.h"></script></p>  <p>Now we can implement a long running process.</p>  <p><strong>A long running process</strong></p>  <p>We took a pretty long look at background threads and processes in day 23 so we’re going to glaze over a few things here.&#160; Specifically, I’m not going to explain how the background thread works but will explain what’s going on.&#160; First we’ll implement the <strong>tappedProcessStuff</strong> method:</p>  <p><script src="https://gist.github.com/4441051.js?file=tappedProcessStuff.m"></script></p>  <p>Essentially we’re spinning up a background thread which does a few seconds worth of sleeping.&#160; Once that is done, we then call the <strong>backgroundDone</strong> method on the main (UI) thread.&#160; In the <strong>backgroundDone</strong> method we’re just going log something for now:</p>  <p><script src="https://gist.github.com/4441051.js?file=backgroundDone1.m"></script></p>  <p>Now run the app.&#160; You should see that it’s possible for you to tap the button again and again and again.&#160; This will start up several background processes which isn’t really what we want.&#160; We don’t want to lock the UI and prevent but we do want to let the user know that something is happening with the app.&#160; Enter the progress indicator.</p>  <p><strong>Adding a progress indicator</strong></p>  <p>First let’s open back up <strong>MainStoryboard.storyboard</strong>.&#160; Drag an <strong>Activity Indicator View</strong> from the UI element selector on to the center of the view:</p>  <p align="center"><img title="adding an activity indicator" alt="adding an activity indicator" src="http://storage.chrisrisner.com/images/31iosday28-activity-indicator.jpg" /></p>  <p>Before we change to do anything in the code side, let’s hide the indicator when it’s not in use.&#160; Click on the activity indicator and open the <strong>Attributes Inspector</strong> in the top right of Xcode.&#160; You’ll want to check the <strong>Hides When Stopped</strong> and <strong>Hidden </strong>boxes:</p>  <p align="center"><img title="Settings for activity indicator" alt="Settings for activity indicator" src="http://storage.chrisrisner.com/images/31iosday28-hidden-and-hide-when-stopped.jpg" /></p>  <p>Now flip over to the <strong>Assistants Editor</strong> and <strong>control + click and drag</strong> from the activity indicator to your code behind to create an outlet.&#160; When you’re done, your header will look like this:</p>  <p><script src="https://gist.github.com/4441051.js?file=ViewController2.h"></script></p>  <p>Now we can use the activity indicator from the code behind.</p>  <p><strong>Animating the activity indicator</strong></p>  <p>Open up <strong>ViewController.m</strong> and go to the <strong>tappedProcessStuff </strong>method.&#160; We just need to make a simple one line change:</p>  <p><script src="https://gist.github.com/4441051.js?file=tappedProcessStuff2.m"></script></p>  <p>We’re calling <strong>startAnimating</strong> on our <strong>indicator</strong>.&#160; This works because we’re doing the extensive processing in a background thread.&#160; If we got rid of the background part and did the loop immediately after the call to <strong>startAnimating</strong> it wouldn’t work.&#160; The reason for this is that control has to be returned to the UI thread in order for the animation to start.&#160; Now, we make a similar one line change to the <strong>backgroundDone</strong> method:</p>  <p><script src="https://gist.github.com/4441051.js?file=backgroundDone2.m"></script></p>  <p>We just call <strong>stopAnimating</strong> on our <strong>indicator</strong> to make it stop and hide (since we told it to hide when stopped).&#160; Now when you run your app and tap the <strong>Process Stuff</strong> button, you’ll see the indicator animating:</p>  <p align="center"><img title="Indicator animating" alt="Indicator animating" src="http://storage.chrisrisner.com/images/31iosday28-indicator-animating.jpg" /></p>  <p>Now let’s talk about another way to indicate things are going on.</p>  <p><strong>Network Activity Indicator</strong></p>  <p>iOS users are use to being told when things are going on.&#160; This can be done with the activity indicator as we did above, but we can also do it with a <strong>Network Activity Indicator</strong>.&#160; Just like we started and stopped animating the indicator with a single line, we can do the same for the network indicator with a single line.&#160; To start it, we call this:</p>  <p>&#160;&#160;&#160; [UIApplication sharedApplication].networkActivityIndicatorVisible = TRUE;</p>  <p>And to turn it off, we would call this:</p>  <p>&#160;&#160;&#160; [UIApplication sharedApplication].networkActivityIndicatorVisible = FALSE;</p>  <p>Now when we run the app, we’ll see a little indicator appear in the black bar at the top of the iPhone by the wifi signal:</p>  <p align="center"><img title="Network activity indicator" alt="Network activity indicator" src="http://storage.chrisrisner.com/images/31iosday28-network-activity-indicator.jpg" /></p>  <p><strong>Progress Bars</strong></p>  <p>The last topic we’re going to cover today is the progress bar.&#160; To do this, start by returning to <strong>MainStoryboard.storyboard</strong>.&#160; This time we’re going to drag a <strong>Progress View</strong> onto our view:</p>  <p align="center"><img title="Progress Bar" alt="Progress Bar" src="http://storage.chrisrisner.com/images/31iosday28-progress-view.jpg" /></p>  <p>Open up the <strong>Assistant editor</strong> and <strong>control + click and drag </strong>from the progress view to your code behind.&#160; When you’re done, it will look like this:</p>  <p><script src="https://gist.github.com/4441051.js?file=ViewController3.h"></script></p>  <p>Now we can switch over to <strong>ViewController.h</strong>. Our first change will be to the <strong>tappedProcessStuff</strong> method:</p>  <p><script src="https://gist.github.com/4441051.js?file=tappedProcessStuff3.m"></script></p>  <p>The only change here is that inside of the loop, we’ve added a call to a new method, <strong>updateProgressBar</strong>.&#160; This call is being made the same way we call the <strong>backgroundDone</strong> method when the loop is finished, on the main UI thread.&#160; We’re also passing in the current count.&#160; Now let’s look at the <strong>updateProgressBar</strong> method:</p>  <p><script src="https://gist.github.com/4441051.js?file=updateProgressBar.m"></script></p>  <p>Here, we’re calculating a progress point by dividing the count by 100.0 (we have to use .0 in order to get the float out).&#160; We can then call <strong>setProgress</strong> on the <strong>progress view</strong> with that value.&#160; Now when you run your app, you should see the progress bar go from empty to filled in time with the loop.</p>  <p><strong>Conclusion</strong></p>  <p>Today we looked at several different ways to show users that things are happening and progress is occuring.&#160; Remember that it’s very important for users to know what’s happening with their device.&#160; If they don’t understand that things are happening behind the scenes, they might not find your app very intuitive or understandable.&#160; Also, always remember to hide or remove or turn off the indicators when you’re done with them.&#160; You can <a title="iOS Day 28" href="http://storage.chrisrisner.com/codesamples/iOSDayTwentyEight.zip">download the completed code from today’s walkthrough here</a>.</p>