---
layout: post
title: "31 Days of iOS: Day 15-Connecting to Built in Apps"
date: Tue Jan 15 2013 08:24:00 GMT-0800 (PST)
comments: true
status: publish
type: post
published: true
categories: [Mobile, Objective-C, XCode, iOS]
excerpt: "This is day 15 in the 31 Days of iOS.  In this article we walk through how to connect your app to other built in apps or functionality.  This includes how to send emails and text messages, open web pages in safari, make phone calls, tweet on Twitter, and post on Facebook."
logoUrl: null
keywords: iOS,31 days of iOS,Apple,Apple iOS,MFMailComposeViewController,presentViewController,send email,MessageUI,MFMailComposeViewControllerDelegate,MFMessageComposeVIewController,openURL,open safari,make phone call,phone,social,tweet,twitter,facebook,iOS Tutorial,Beginners,walkthrough
filepath: 2013-01-15-31-Days-of-iOS--Day-15-Connecting-to-Built-in-Apps.html
disqus_identifier: 31-Days-of-iOS--Day-15–Connecting-to-Built-in-Apps
redirect_from:
  - /2013-01-15-31-Days-of-iOS--Day-15%E2%80%93Connecting-to-Built-in-Apps/
---
<p align="left"><img style="margin: 0px 0px 5px 5px; display: inline; float: right" align="right" src="http://chrisrisner.com/upload/200px-Apple-logo.png" width="170" height="208" />Welcome to Day 15 in the <a title="31 Days of iOS" href="http://chrisrisner.com/31-Days-of-iOS">31 Days of iOS</a>.&#160; <a title="Day 14: The UIWebView" href="http://chrisrisner.com/31-Days-of-iOS--Day-14%E2%80%93The-UIWebView">Yesterday</a>, we covered everything there was to do with <strong>UIWebViews</strong>.&#160; Today we’re going to look at a different topic:&#160; connecting our app to other apps in iOS.&#160; Specifically, we’ll look at using the email composer, launching Safari, making phone calls, and other ways of using functionality available on iOS devices but not necessarily built within your application.&#160; We’ll be starting with a brand new project, but if you’d like to follow along with the <a title="iOS Day 15 Source code" href="https://crcomcstorage.blob.core.windows.net/codesamples/iOSDayFifteen.zip">completed code, you can access it here</a>.</p>  <p align="left"><strong>Creating our project and handling the UI</strong></p>  <p align="left">Open up Xcode and choose <strong>File</strong>, <strong>New</strong>, <strong>Project</strong>.&#160; We’ll use a <strong>Single View Application</strong> and name it <strong>DayFifteen</strong>:</p>  <p align="center"><img title="iOS Day 15" alt="iOS Day 15" src="https://crcomcstorage.blob.core.windows.net/images/31iosday15-new-project.jpg" width="448" height="374" /></p>  <p align="left">Next, open up the <strong>MainStoryboard.storyboard</strong> file.&#160; We need to add a few buttons to our UI to trigger the actions we’re going to perform.&#160; Go ahead and add 6 buttons to your UI so it looks like this:</p>  <p align="center"><img title="day 15 iOS UI" alt="day 15 iOS UI" src="https://crcomcstorage.blob.core.windows.net/images/31iosday15-ui.jpg" width="247" height="322" /></p>  <p align="left">Now open the <strong>Assistant Editor</strong> in the top right of the <strong>Utilities pane</strong> and <strong>control + click and drag</strong> from each button to your code behind to create actions.&#160; When you’re finished, the header file should look like this:</p>  <p align="left"><script src="https://gist.github.com/4064206.js?file=viewcontroller.h"></script></p>  <p align="left">Now we can see how to wire up all of these buttons.</p>  <p align="left"><strong>Opening the email composer</strong></p>  <p align="left">When opening an email composer, you have the option of specifying a lot of information to start including the subject, body, recipients, and more.&#160; We’re just going to se the subject and header here:</p>  <p align="left"><script src="https://gist.github.com/4064206.js?file=showmailcomposer.m"></script></p>  <p align="left">This won’t compile right away.&#160; The reason is that you need to import the <strong>MessageUI</strong> library:</p>  <blockquote>   <p align="left">#import &lt;MessageUI/MessageUI.h&gt;</p> </blockquote>  <p align="left">Now if you run the app, it will fail with a different compiler error:</p>  <blockquote>   <p>Undefined symbols for architecture i386:      <br />&#160; &quot;_OBJC_CLASS_$_MFMailComposeViewController&quot;, referenced from:</p> </blockquote>  <p align="left">To fix this, you need to go into your project’s target and open the <strong>Build Phases</strong> tab.&#160; From there, you’ll need to to expand the <strong>Link Binary with Libraries</strong> and add <strong>MessageUI.framework</strong>:</p>  <p align="center"><img title="Adding MessageUI" alt="Adding MessageUI" src="https://crcomcstorage.blob.core.windows.net/images/31iosday15-add-messageui.jpg" /></p>  <p align="left">Now when you compile and run and tap the <strong>Email </strong>button, you should see the email composer:</p>  <p align="center"><img title="email composer" alt="email composer" src="https://crcomcstorage.blob.core.windows.net/images/31iosday15-email-composer.jpg" width="277" height="272" /></p>  <p align="left">Now if you send or cancel, it won’t actually get rid of the composer.&#160; That’s because doing so fires a delegate method for the composer.&#160; In our code above, we set the <strong>mailComposeDelegate </strong>for the composer to be <strong>ViewController</strong> but we didn’t actually implement the delegate.&#160; Let’s do this now.&#160; Switch over to the <strong>ViewController.h </strong>file and implement the <strong>MFMailComposeViewControllerDelegate</strong>:</p>  <p align="left"><script src="https://gist.github.com/4064206.js?file=MFMailComposerdelegate"></script></p>  <p align="left">Next, switch over to <strong>ViewController.m</strong>.&#160; The method we need to implement is <strong>mailComposerController didFinishWithResult</strong>:</p>  <p align="left"><script src="https://gist.github.com/4064206.js?file=mailComposeDelegaetMethod.m"></script></p>  <p align="left">Notice that we will get a different result back depending on what the user did in the composer.&#160; You may have noticed earlier that the <strong>setMessageBody</strong> method on the mail composer took in a <strong>isHTML </strong>parameter.&#160; This is because the composer in iOS supports HTML.&#160; You won’t really be able to edit the html in the composer but it is possible to send a decent looking html email with it.</p>  <p align="left"><strong>Sending SMS Messages</strong></p>  <p align="left">Sending text (or SMS) messages is nearly identical to sending emails.&#160; Instead of using <strong>MFMail</strong>, we use <strong>MFMessage:</strong></p>  <p align="left"><script src="https://gist.github.com/4064206.js?file=mfmessage.m"></script></p>  <p align="left">Notice that the first thing we check is if the <strong>MFMessageComposeViewController</strong> class can send text’s with the <strong>canSendText</strong> method.&#160; This is necessary because we may be running on devices without a phone (such as an iPad) or even the simulator.&#160; Again we see that if you open the message composer and cancel or send, it doesn’t go away.&#160; We need to implement the delegate method for the message composer just like we did for the mail.&#160; Start by going to the <strong>ViewController.h</strong> file and implementing the <strong>MFMessageComposeViewControllerDelegate</strong>:</p>  <p align="left"><script src="https://gist.github.com/4064206.js?file=MFMessage.h"></script></p>  <p align="left">And the delegate method we implement is also similar:</p>  <p align="left"><script src="https://gist.github.com/4064206.js?file=messagedelegate.m"></script></p>  <p align="left">That’s all there is to opening texts.</p>  <p><strong>Opening a URL in Safari</strong></p>  <p>We already reviewed how to load web pages in a <strong>UIWebView</strong> a few days ago.&#160; However, if you want to make use of mobile Safari which works better than the web view, you can do so.&#160; In fact, opening a URL in Safari will be the easiest thing we’ve done today as it only requires a single line of code:</p>  <p><script src="https://gist.github.com/4064206.js?file=OpeningURL.m"></script></p>  <p><strong>openUrl</strong>, as you’ll see, is kind of a multi-purpose tool.&#160; Here we’re just sending in a <strong>NSURL</strong> with a a web address.&#160; Running your app now will result in Safari opening to <a href="http://www.windowsazure.com">http://www.windowsazure.com</a>.</p>  <p><strong>Makin a phone call</strong></p>  <p>To make a phone call, we make use of the <strong>openUrl </strong>method again:</p>  <p><script src="https://gist.github.com/4064206.js?file=makephonecall.m"></script></p>  <p>Here we’re first using the <strong>canOpenUrl</strong> method to make sure the device can respond to making a phone call.&#160; This, just like checking to see if it could send texts above, is useful in seeing if the device doesn’t support telephony.&#160; You would probably want to handle your UI differently and not have a “make a phone call” button if they didn’t have a phone.</p>  <p><strong>Tweeting from our app</strong></p>  <p>As of iOS 5, a Twitter framework was included with iOS.&#160; This means that interacting with Twitter from your app is much easier than figuring out what library to use on GitHub and then trying to incorporate it into your project.&#160; To start, open your project’s target and go to <strong>Link Binary with Libraries </strong>again and add<strong> Twitter.framework</strong>:</p>  <p align="center"><img title="social framework" alt="social framework" src="https://crcomcstorage.blob.core.windows.net/images/31iosday15-social-framwork.jpg" /></p>  <p>Once that is done, you can return to <strong>ViewController.m </strong>and add the following import statement:</p>  <blockquote>   <p>#import &lt;Social/Social.h&gt;</p> </blockquote>  <p>Now we can actually handle the tweet:</p>  <p><script src="https://gist.github.com/4064206.js?file=tappedSendTweet.m"></script></p>  <p>The first thing we need to do is check that tweeting is available by using <strong>SLComposeViewController’s isAvailableForServiceType</strong> method and passing in <strong>SLServiceTypeTwitter</strong>.&#160; Provided this is true, we can then continue with the tweet.&#160; We create a new <strong>SLComposeViewController </strong>and set it’s service type using <strong>SLServiceTypeTwitter</strong>.&#160; We’re setting the initial text of the <strong>composerSheet</strong> and then presenting that view to users.&#160; After that we set the completion handler for the social view controller and make it handle either the tweet being done or cancelled.&#160; Now when we run our app we should see a nice twitter window show up:</p>  <p align="center"><img title="Twitter in iOS" alt="Twitter in iOS" src="https://crcomcstorage.blob.core.windows.net/images/31iosday15-tweet.jpg" /></p>  <p>In this situation it’s complaining that no accounts are set up (because I haven't added any yet).&#160; </p>  <p><strong>Posting to Facebook</strong></p>  <p>Now that we’ve seen how to handle Twitter, Facebook will be very easy.&#160; In fact, we’ll just change <strong>SLServiceTypeTwitter </strong>to <strong>SLServiceTypeFacebook</strong>:</p>  <p><script src="https://gist.github.com/4064576.js?file=facebook.m"></script></p>  <p>It’s possible to get a little fancier with your posts to facebook and twitter and pass in images as well.</p>  <p><strong>Conclusion</strong></p>  <p>iOS offers a lot of areas where you can make use of the functionality and accounts set up on the rest of the device.&#160; Today we looked at how to pull up the email and SMS composers, how to open Safari, how to place a phone call, and how to tweet and post to Facebook from your applications.&#160; Using this ability, you should now be able to make an app that really integrates and feels at home running on iOS.&#160; You can <a title="iOS Day 15 Source code" href="https://crcomcstorage.blob.core.windows.net/codesamples/iOSDayFifteen.zip">access the finished source code from today here</a>.</p>