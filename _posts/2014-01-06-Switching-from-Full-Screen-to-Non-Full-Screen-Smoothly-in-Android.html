---
layout: post
title: "Switching from Full Screen to Non Full Screen Smoothly in Android"
date: Mon Jan 06 2014 09:39:00
commentsOn: true
status: publish
type: post
published: true
categories: [Android, Java]
excerpt: "This article details some issues with going from a full screen Activity without the status bar showing to an Activity with the status bar showing and some of the quirks that occur when doing this."
logoUrl: null
keywords: Android,android dev,screen,layout,transition,full screen,actionbar,action bar,statusbar,status bar
filepath: 2014-01-06-Switching-from-Full-Screen-to-Non-Full-Screen-Smoothly-in-Android.html
disqus_identifier: Switching-from-Full-Screen-to-Non-Full-Screen-Smoothly-in-Android
---
<p>
<strong>Update 2/20/2014: Due to a few issues, the app formally known as PikShare has been renamed LensRocket. Everything except some names remains the exact same as the originally released source code and application. </strong>
<br /><br />
<strong>Update: </strong>At the time of writing, this seemed to work fine on the multiple devices I had tested on.&#160; However, by the time I launched the app, I started seeing issues with the one device I had running KitKat.&#160; Let that serve as a reminder to test your apps on every device and OS version you can and test as soon as a new version is released.&#160; </p>  <p>While working on the Android version of <a title="LensRocket for Android" href="http://chrisrisner.com/LensRocket--A-Photo-and-Video-Sharing-App-Built-with-Windows-Azure">LensRocket</a>, I ran into a pretty big smoothness issue.&#160; Specifically, when you go from a full screen activity to a non-full screen activity, there can be an issue related to the ActionBar appearing underneath the notification bar as the notification bar slides down.&#160; Unless you’re currently running into this exact issue, that might be hard to picture.&#160; Thankfully, I' put together a little animation for you to check out:</p>  <p align="center"><img title="Issues with ActionBar and NotificationBar" alt="Issues with ActionBar and NotificationBar" src="http://storage.chrisrisner.com/images/pietalk-actionbar-notificationbar.gif" width="200" height="319" /></p>  <p>As you can see, when the button is tapped, the <strong>RocketsListActivity</strong> slides in from the left.&#160; When it does so, the notification bar starts sliding down at the same time.&#160; Since when the activity first starts sliding in, the notification bar isn’t there, it’s displayed at the top of the screen.&#160; Once the notification bar finishes it’s slide down, the action bar is then “shoved” down (or it jumps down or bounces down or is pushed down, whatever you prefer).&#160; This looks pretty terrible and would certainly not be part of any polished app.&#160; Fixing this didn’t was far from easy to figure out, however, the solution ends up being “fairly” simple.</p>  <p><strong>Styling the ActionBar</strong></p>  <p>The first step in fixing this was something I had already set up while working on this app which was customizing the style of the ActionBar.&#160; If you create a new Android project you’ll end up with a <strong>styles.xml</strong> file which has some values by default (at least as of several versions of the ADT ago) and looks like this:</p>  <p><script src="https://gist.github.com/ChrisRisner/6820727.js?file=default_style.xml"></script></p>  <p>This gives you a place to override the default styles of your application.&#160; In this case it’s overriding the <strong>Theme.Light</strong> theme.&#160; In order to override the appearance of our ActionBar, we’ll use this styles file.&#160; To start doing so, we just need to drop this into the <strong>AppTheme</strong> style:</p>  <blockquote>   <p>&lt;item name=&quot;android:actionBarStyle&quot;&gt;@style/ActionBarStyle&lt;/item&gt;</p> </blockquote>  <p>This says that we want to override the style of our ActionBar’s with a new style called <strong>ActionBarStyle</strong>.&#160; In the case of the above application, that style looks like this:</p>  <p><script src="https://gist.github.com/ChrisRisner/6820727.js?file=action_bar_style.xml"></script></p>  <p>The specifics here don’t matter too much.&#160; We’re setting a few colors and then pointing the <strong>titleTextStyle</strong> at an additional style.&#160; In order to solve our problem, we need to add one more element to this <strong>style</strong>:</p>  <blockquote>   <p>&lt;item name=&quot;android:layout_marginTop&quot;&gt;12dp&lt;/item&gt;</p> </blockquote>  <p>Oddly enough, as of writing, if you try to autocomplete the <strong>layout_marginTop</strong> name value, it doesn’t show up as an option.&#160; This initially lead me to believe that it wasn’t a valid attribute.&#160; Testing would prove otherwise.&#160; Essentially, putting this value in means that our action bar will have a margin above it (in this case a margin of 12dp).&#160; Doing this and rerunning our app gives us something that looks like this:</p>  <p align="center"><img title="actionbar with margin" alt="actionbar with margin" src="http://storage.chrisrisner.com/images/pieslistactivity_actionbar_margin.jpg" /></p>  <p>So now we know that the margin works.&#160; Unfortunately, things still look terrible.&#160; Thankfully, the last step is equally easy!</p>  <p><strong>Setting Window Flags</strong></p>  <p>The problem we have is that our screen still has to adjust when the ActionBar gets to the bottom of it’s slide down.&#160; Wouldn’t it be ideal if we could tell our content view to ignore the notification bar.&#160; As luck would have it, we can!&#160; To do so, open up the <strong>onCreate </strong>method of the activity that will show the notification bar and action bar (so in the case above, <strong>PiksListActivity</strong>).&#160; Prior to setting the content view, we need to get access to the window object and add flags to it.&#160; Specifically, the flags for <strong>FLAG_LAYOUT_IN_SCREEN</strong> and <strong>FLAG_LAYOUT_NO_LIMITS</strong>:</p>  <p><script src="https://gist.github.com/ChrisRisner/6820727.js?file=onCreate.java"></script></p>  <p>Once we’ve done that and run again, we get something much better that looks like this:</p>  <p align="center"><img title="Action bar and Notification Bar fixed" alt="Action bar and Notification Bar fixed" src="http://storage.chrisrisner.com/images/pietalk-actionbar-fixed.gif" width="180" height="281" /></p>  <p>Basically we’ve set some flags that told our view to use the full screen and ignore anything else on the screen (i.e the notification bar).&#160; Once we’ve done that, our view will ignore the notification bar and not reposition itself when the notification bar finishes sliding down.&#160; Observant people will see a bit of white between the action bar and the notification bar as they slide together.&#160; I would just fix this by setting the background of the view to be black to match the notification bar and it wouldn’t look as weird.</p>  <p><strong>Summary</strong></p>  <p>Now you should know how to handle making a nice smooth transition from full screen to a non-full screened activity.&#160; This can be a little easier if you’re not using an action bar (you’d just put a top padding on your content view) but it should be pretty easy to handle regardless of what you’re doing now.&#160; Let me know if you have any questions!</p>